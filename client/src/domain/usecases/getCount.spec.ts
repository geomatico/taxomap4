import {expect} from 'chai';
import getCount from './getCount';
import {readTestTaxomapData} from '../../test/testData';
import {FilterBy, TaxonomicLevel} from '../../commonTypes';

describe('getCount', () => {
  it('Counts occurences by year', async () => {
    // GIVEN
    const data = await readTestTaxomapData();
    const filters = {
      taxon: {
        level: TaxonomicLevel.domain,
        id: 1 // Eukaryota
      }
    };
    const groupBy = FilterBy.year;

    // WHEN
    const counts = getCount(data, filters, groupBy);

    // THEN
    expect(counts).to.deep.equal({0: 94974, 1852: 2, 1855: 1, 1857: 1, 1861: 1, 1862: 2, 1863: 1, 1867: 3, 1868: 4, 1869: 2, 1870: 1, 1871: 2, 1873: 1, 1874: 2, 1876: 1, 1877: 1, 1880: 5, 1881: 15, 1882: 1, 1883: 1, 1884: 3, 1885: 1, 1886: 3, 1887: 2, 1888: 6, 1889: 7, 1890: 5, 1891: 5, 1892: 1, 1893: 3, 1894: 15, 1895: 11, 1896: 14, 1897: 17, 1898: 19, 1899: 20, 1900: 60, 1901: 39, 1902: 33, 1903: 66, 1904: 9, 1905: 30, 1906: 23, 1907: 31, 1908: 78, 1909: 103, 1910: 117, 1911: 75, 1912: 83, 1913: 64, 1914: 127, 1915: 163, 1916: 225, 1917: 591, 1918: 975, 1919: 1589, 1920: 1100, 1921: 1206, 1922: 736, 1923: 610, 1924: 425, 1925: 562, 1926: 369, 1927: 230, 1928: 183, 1929: 437, 1930: 332, 1931: 147, 1932: 714, 1933: 357, 1934: 430, 1935: 393, 1936: 104, 1937: 60, 1938: 18, 1939: 287, 1940: 99, 1941: 235, 1942: 304, 1943: 95, 1944: 67, 1945: 119, 1946: 398, 1947: 294, 1948: 261, 1949: 174, 1950: 106, 1951: 152, 1952: 272, 1953: 72, 1954: 178, 1955: 100, 1956: 208, 1957: 250, 1958: 234, 1959: 323, 1960: 678, 1961: 387, 1962: 381, 1963: 448, 1964: 488, 1965: 363, 1966: 821, 1967: 1139, 1968: 702, 1969: 861, 1970: 576, 1971: 1603, 1972: 566, 1973: 971, 1974: 1236, 1975: 799, 1976: 853, 1977: 730, 1978: 720, 1979: 1295, 1980: 1573, 1981: 2156, 1982: 1434, 1983: 1070, 1984: 1035, 1985: 1600, 1986: 1897, 1987: 1390, 1988: 1234, 1989: 1108, 1990: 1341, 1991: 2130, 1992: 1596, 1993: 1846, 1994: 1605, 1995: 1838, 1996: 1962, 1997: 1686, 1998: 1934, 1999: 1479, 2000: 1786, 2001: 1413, 2002: 1406, 2003: 1548, 2004: 1176, 2005: 1203, 2006: 1470, 2007: 1042, 2008: 743, 2009: 1422, 2010: 2298, 2011: 1507, 2012: 2274, 2013: 2571, 2014: 2293, 2015: 2191, 2016: 2016, 2017: 1915, 2018: 1874, 2019: 1678});
  });
});
